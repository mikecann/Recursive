var TSM;
(function(q){var c=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(3);a&&(this.xyz=a)};Object.defineProperty(c.prototype,"x",{get:function(){return this.values[0]},set:function(a){this.values[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"y",{get:function(){return this.values[1]},set:function(a){this.values[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"z",{get:function(){return this.values[2]},set:function(a){this.values[2]=a},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"xyz",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1];this.values[2]=a[2]},enumerable:!0,configurable:!0});c.prototype.at=function(a){return this.values[a]};c.prototype.reset=
function(){for(var a=0;3>a;a++)this.values[a]=0};c.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new c);for(var b=0;3>b;b++)a.values[b]=this.values[b];return a};c.prototype.negate=function(){for(var a=0;3>a;a++)this.values[a]*=-1;return this};c.prototype.equals=function(a){for(var b=0;3>b;b++)if(Math.abs(this.values[b]-a.at(b))>EPSILON)return!1;return!0};c.prototype.length=function(){return Math.sqrt(this.squaredLength())};c.prototype.squaredLength=function(){var a=this.x,b=this.y,
d=this.z;return a*a+b*b+d*d};c.prototype.add=function(a){for(var b=0;3>b;b++)this.values[b]+=a.at(b);return this};c.prototype.subtract=function(a){for(var b=0;3>b;b++)this.values[b]-=a.at(b);return this};c.prototype.multiply=function(a){for(var b=0;3>b;b++)this.values[b]*=a.at(b);return this};c.prototype.divide=function(a){for(var b=0;3>b;b++)this.values[b]/=a.at(b);return this};c.prototype.scale=function(a){for(var b=0;3>b;b++)this.values[b]*=a;return this};c.prototype.normalize=function(){var a=
this.length();if(1===a)return this;if(0===a){for(var b=0;3>b;b++)this.values[b]=0;return this}a=1/a;for(b=0;3>b;b++)this.values[b]*=a;return this};c.cross=function(a,b,d){"undefined"===typeof d&&(d=null);var g=a.x,e=a.y,a=a.z,f=b.x,h=b.y,b=b.z;if(d)d.xyz=[e*b-a*h,a*f-g*b,g*h-e*f];else return new c([e*b-a*h,a*f-g*b,g*h-e*f])};c.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};c.distance=function(a,b){return Math.sqrt(this.squaredDistance(a,b))};c.squaredDistance=function(a,b){var d=b.x-a.x,c=b.y-
a.y,e=b.z-a.z;return d*d+c*c+e*e};c.direction=function(a,b,d){"undefined"===typeof d&&(d=null);var g=a.x-b.x,e=a.y-b.y,a=a.z-b.z,b=Math.sqrt(g*g+e*e+a*a);if(0===b)return new c([0,0,0]);b=1/b;if(d)d.xyz=[g*b,e*b,a*b];else return new c([g*b,e*b,a*b])};c.interpolate=function(a,b,d,g){"undefined"===typeof g&&(g=null);var e=a.x,f=a.y,a=a.z,h=b.x,j=b.y,b=b.z;if(g)g.xyz=[e+d*(h-e),f+d*(j-f),a+d*(b-a)];else return new c([e+d*(h-e),f+d*(j-f),a+d*(b-a)])};c.sum=function(a,b,d){"undefined"===typeof d&&(d=null);
if(d)d.xyz=[a.x+b.x,a.y+b.y,a.z+b.z];else return new c([a.x+b.x,a.y+b.y,a.z+b.z])};c.difference=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xyz=[a.x-b.x,a.y-b.y,a.z-b.z];else return new c([a.x-b.x,a.y-b.y,a.z-b.z])};c.product=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xyz=[a.x*b.x,a.y*b.y,a.z*b.z];else return new c([a.x*b.x,a.y*b.y,a.z*b.z])};c.quotient=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xyz=[a.x/b.x,a.y/b.y,a.z/b.z];else return new c([a.x/b.x,a.y/b.y,
a.z/b.z])};c.prototype.toQuat=function(){var a=new c,b=new c;a.x=Math.cos(0.5*this.x);b.x=Math.sin(0.5*this.x);a.y=Math.cos(0.5*this.y);b.y=Math.sin(0.5*this.y);a.z=Math.cos(0.5*this.z);b.z=Math.sin(0.5*this.z);return new q.quat([b.x*a.y*a.z-a.x*b.y*b.z,a.x*b.y*a.z+b.x*a.y*b.z,a.x*a.y*b.z-b.x*b.y*a.z,a.x*a.y*a.z+b.x*b.y*b.z])};c.zero=new c([0,0,0]);c.up=new c([0,1,0]);c.right=new c([1,0,0]);c.forward=new c([0,0,1]);q.vec3=c})(TSM||(TSM={}));
(function(q){var c=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(4);a&&(this.xyzw=a)};Object.defineProperty(c.prototype,"x",{get:function(){return this.values[0]},set:function(a){this.values[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"y",{get:function(){return this.values[1]},set:function(a){this.values[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"z",{get:function(){return this.values[2]},set:function(a){this.values[2]=
a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"w",{get:function(){return this.values[3]},set:function(a){this.values[3]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"xyz",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(a){this.values[0]=
a[0];this.values[1]=a[1];this.values[2]=a[2]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"xyzw",{get:function(){return[this.values[0],this.values[1],this.values[2],this.values[3]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1];this.values[2]=a[2];this.values[3]=a[3]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"r",{get:function(){return this.values[0]},set:function(a){this.values[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"g",{get:function(){return this.values[1]},set:function(a){this.values[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"b",{get:function(){return this.values[2]},set:function(a){this.values[2]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"a",{get:function(){return this.values[3]},set:function(a){this.values[3]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"rg",{get:function(){return[this.values[0],this.values[1]]},set:function(a){this.values[0]=
a[0];this.values[1]=a[1]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"rgb",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1];this.values[2]=a[2]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"rgba",{get:function(){return[this.values[0],this.values[1],this.values[2],this.values[3]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1];this.values[2]=a[2];this.values[3]=a[3]},enumerable:!0,
configurable:!0});c.prototype.at=function(a){return this.values[a]};c.prototype.reset=function(){for(var a=0;4>a;a++)this.values[a]=0};c.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new c);for(var b=0;4>b;b++)a.values[b]=this.values[b];return a};c.prototype.negate=function(){for(var a=0;4>a;a++)this.values[a]*=-1;return this};c.prototype.equals=function(a){for(var b=0;4>b;b++)if(Math.abs(this.values[b]-a.at(b))>EPSILON)return!1;return!0};c.prototype.length=function(){return Math.sqrt(this.squaredLength())};
c.prototype.squaredLength=function(){var a=this.x,b=this.y,d=this.z,c=this.w;return a*a+b*b+d*d+c*c};c.prototype.add=function(a){for(var b=0;4>b;b++)this.values[b]+=a.at(b);return this};c.prototype.subtract=function(a){for(var b=0;4>b;b++)this.values[b]-=a.at(b);return this};c.prototype.multiply=function(a){for(var b=0;4>b;b++)this.values[b]*=a.at(b);return this};c.prototype.divide=function(a){for(var b=0;4>b;b++)this.values[b]/=a.at(b);return this};c.prototype.scale=function(a){for(var b=0;4>b;b++)this.values[b]*=
a;return this};c.prototype.normalize=function(){var a=this.length();if(1===a)return this;if(0===a){for(var b=0;4>b;b++)this.values[b]=0;return this}a=1/a;for(b=0;4>b;b++)this.values[b]*=a;return this};c.interpolate=function(a,b,d,g){"undefined"===typeof g&&(g=null);if(g)g.xyzw=[a.x+d*(b.x-a.x),a.y+d*(b.y-a.y),a.z+d*(b.z-a.z),a.w+d*(b.w-a.w)];else return new c([a.x+d*(b.x-a.x),a.y+d*(b.y-a.y),a.z+d*(b.z-a.z),a.w+d*(b.w-a.w)])};c.sum=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xyzw=[a.x+
b.x,a.y+b.y,a.z+b.z,a.w+b.w];else return new c([a.x+b.x,a.y+b.y,a.z+b.z,a.w+b.w])};c.difference=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xyzw=[a.x-b.x,a.y-b.y,a.z-b.z,a.w-b.w];else return new c([a.x-b.x,a.y-b.y,a.z-b.z,a.w-b.w])};c.product=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xyzw=[a.x*b.x,a.y*b.y,a.z*b.z,a.w*b.w];else return new c([a.x*b.x,a.y*b.y,a.z*b.z,a.w*b.w])};c.quotient=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xyzw=[a.x/b.x,a.y/b.y,a.z/b.z,
a.w/b.w];else return new c([a.x/b.x,a.y/b.y,a.z/b.z,a.w/b.w])};c.zero=new c([0,0,0,1]);q.vec4=c})(TSM||(TSM={}));
(function(q){var c=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(4);a&&this.init(a)};c.prototype.at=function(a){return this.values[a]};c.prototype.init=function(a){for(var b=0;4>b;b++)this.values[b]=a[b];return this};c.prototype.reset=function(){for(var a=0;4>a;a++)this.values[a]=0};c.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new c);for(var b=0;4>b;b++)a.values[b]=this.values[b];return a};c.prototype.all=function(){for(var a=[],b=0;4>b;b++)a[b]=
this.values[b];return a};c.prototype.row=function(a){return[this.values[2*a+0],this.values[2*a+1]]};c.prototype.col=function(a){return[this.values[a],this.values[a+2]]};c.prototype.equals=function(a){for(var b=0;4>b;b++)if(Math.abs(this.values[b]-a.at(b))>EPSILON)return!1;return!0};c.prototype.determinant=function(){return this.values[0]*this.values[3]-this.values[2]*this.values[1]};c.prototype.setIdentity=function(){this.values[0]=1;this.values[1]=0;this.values[2]=0;this.values[3]=1;return this};
c.prototype.transpose=function(){var a=this.values[1];this.values[1]=this.values[2];this.values[2]=a;return this};c.prototype.inverse=function(){var a=this.determinant();if(!a)return null;a=1/a;this.values[0]=a*this.values[3];this.values[1]=a*-this.values[1];this.values[2]=a*-this.values[2];this.values[3]=a*this.values[0];return this};c.prototype.multiply=function(a){var b=this.values[0],d=this.values[1],c=this.values[2],e=this.values[3];this.values[0]=b*a.at(0)+d*a.at(2);this.values[1]=b*a.at(1)+
d*a.at(3);this.values[2]=c*a.at(0)+e*a.at(2);this.values[3]=c*a.at(1)+e*a.at(3);return this};c.prototype.rotate=function(a){var b=this.values[0],d=this.values[1],c=this.values[2],e=this.values[3],f=Math.sin(a),a=Math.cos(a);this.values[0]=b*a+d*f;this.values[1]=b*-f+d*a;this.values[2]=c*a+e*f;this.values[3]=c*-f+e*a;return this};c.prototype.multiplyVec2=function(a){var b=a.x,a=a.y;return new q.vec2([b*this.values[0]+a*this.values[1],b*this.values[2]+a*this.values[3]])};c.prototype.scale=function(a){var b=
this.values[1],d=this.values[2],c=this.values[3],e=a.x,a=a.y;this.values[0]*=e;this.values[1]=b*a;this.values[2]=d*e;this.values[3]=c*a;return this};c.product=function(a,b,d){"undefined"===typeof d&&(d=null);var g=a.at(0),e=a.at(1),f=a.at(2),a=a.at(3);if(d)d.init([g*b.at(0)+e*b.at(2),g*b.at(1)+e*b.at(3),f*b.at(0)+a*b.at(2),f*b.at(1)+a*b.at(3)]);else return new c([g*b.at(0)+e*b.at(2),g*b.at(1)+e*b.at(3),f*b.at(0)+a*b.at(2),f*b.at(1)+a*b.at(3)])};c.identity=(new c).setIdentity();q.mat2=c})(TSM||(TSM=
{}));
(function(q){var c=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(9);a&&this.init(a)};c.prototype.at=function(a){return this.values[a]};c.prototype.init=function(a){for(var b=0;9>b;b++)this.values[b]=a[b];return this};c.prototype.reset=function(){for(var a=0;9>a;a++)this.values[a]=0};c.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new c);for(var b=0;9>b;b++)a.values[b]=this.values[b];return a};c.prototype.all=function(){for(var a=[],b=0;9>b;b++)a[b]=this.values[b];
return a};c.prototype.row=function(a){return[this.values[3*a+0],this.values[3*a+1],this.values[3*a+2]]};c.prototype.col=function(a){return[this.values[a],this.values[a+3],this.values[a+6]]};c.prototype.equals=function(a){for(var b=0;9>b;b++)if(Math.abs(this.values[b]-a.at(b))>EPSILON)return!1;return!0};c.prototype.determinant=function(){var a=this.values[3],b=this.values[4],d=this.values[5],c=this.values[6],e=this.values[7],f=this.values[8];return this.values[0]*(f*b-d*e)+this.values[1]*(-f*a+d*c)+
this.values[2]*(e*a-b*c)};c.prototype.setIdentity=function(){this.values[0]=1;this.values[1]=0;this.values[2]=0;this.values[3]=0;this.values[4]=1;this.values[5]=0;this.values[6]=0;this.values[7]=0;this.values[8]=1;return this};c.prototype.transpose=function(){var a=this.values[1],b=this.values[2],d=this.values[5];this.values[1]=this.values[3];this.values[2]=this.values[6];this.values[3]=a;this.values[5]=this.values[7];this.values[6]=b;this.values[7]=d;return this};c.prototype.inverse=function(){var a=
this.values[0],b=this.values[1],d=this.values[2],c=this.values[3],e=this.values[4],f=this.values[5],h=this.values[6],j=this.values[7],i=this.values[8],l=i*e-f*j,m=-i*c+f*h,n=j*c-e*h,k=a*l+b*m+d*n;if(!k)return null;k=1/k;this.values[0]=l*k;this.values[1]=(-i*b+d*j)*k;this.values[2]=(f*b-d*e)*k;this.values[3]=m*k;this.values[4]=(i*a-d*h)*k;this.values[5]=(-f*a+d*c)*k;this.values[6]=n*k;this.values[7]=(-j*a+b*h)*k;this.values[8]=(e*a-b*c)*k;return this};c.prototype.multiply=function(a){var b=this.values[0],
d=this.values[1],c=this.values[2],e=this.values[3],f=this.values[4],h=this.values[5],j=this.values[6],i=this.values[7],l=this.values[8],m=a.at(0),n=a.at(1),k=a.at(2),s=a.at(3),t=a.at(4),u=a.at(5),x=a.at(6),p=a.at(7),a=a.at(8);this.values[0]=m*b+n*e+k*j;this.values[1]=m*d+n*f+k*i;this.values[2]=m*c+n*h+k*l;this.values[3]=s*b+t*e+u*j;this.values[4]=s*d+t*f+u*i;this.values[5]=s*c+t*h+u*l;this.values[6]=x*b+p*e+a*j;this.values[7]=x*d+p*f+a*i;this.values[8]=x*c+p*h+a*l;return this};c.prototype.multiplyVec2=
function(a){var b=a.x,a=a.y;return new q.vec2([b*this.values[0]+a*this.values[3]+this.values[6],b*this.values[1]+a*this.values[4]+this.values[7]])};c.prototype.multiplyVec3=function(a){var b=a.x,d=a.y,a=a.z;return new q.vec3([b*this.values[0]+d*this.values[3]+a*this.values[6],b*this.values[1]+d*this.values[4]+a*this.values[7],b*this.values[2]+d*this.values[5]+a*this.values[8]])};c.prototype.toMat4=function(){return new q.mat4([this.values[0],this.values[1],this.values[2],0,this.values[3],this.values[4],
this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1])};c.prototype.rotate=function(a,b){var d=b.x,c=b.y,e=b.z,f=Math.sqrt(d*d+c*c+e*e);if(!f)return null;1!==f&&(f=1/f,d*=f,c*=f,e*=f);var h=Math.sin(a),j=Math.cos(a),i=1-j,f=this.values[0],l=this.values[1],m=this.values[2],n=this.values[4],k=this.values[5],s=this.values[6],t=this.values[8],u=this.values[9],x=this.values[10],p=d*d*i+j,r=c*d*i+e*h,w=e*d*i-c*h,v=d*c*i-e*h,q=c*c*i+j,z=e*c*i+d*h,A=d*e*i+c*h,d=c*e*i-d*h,e=e*e*i+j;this.values[0]=
f*p+n*r+t*w;this.values[1]=l*p+k*r+u*w;this.values[2]=m*p+s*r+x*w;this.values[3]=f*v+n*q+t*z;this.values[4]=l*v+k*q+u*z;this.values[5]=m*v+s*q+x*z;this.values[6]=f*A+n*d+t*e;this.values[7]=l*A+k*d+u*e;this.values[8]=m*A+s*d+x*e;return this};c.product=function(a,b,d){"undefined"===typeof d&&(d=null);var g=a.at(0),e=a.at(1),f=a.at(2),h=a.at(3),j=a.at(4),i=a.at(5),l=a.at(6),m=a.at(7),a=a.at(8),n=b.at(0),k=b.at(1),s=b.at(2),t=b.at(3),u=b.at(4),x=b.at(5),p=b.at(6),r=b.at(7),b=b.at(8);if(d)d.init([n*g+
k*h+s*l,n*e+k*j+s*m,n*f+k*i+s*a,t*g+u*h+x*l,t*e+u*j+x*m,t*f+u*i+x*a,p*g+r*h+b*l,p*e+r*j+b*m,p*f+r*i+b*a]);else return new c([n*g+k*h+s*l,n*e+k*j+s*m,n*f+k*i+s*a,t*g+u*h+x*l,t*e+u*j+x*m,t*f+u*i+x*a,p*g+r*h+b*l,p*e+r*j+b*m,p*f+r*i+b*a])};c.identity=(new c).setIdentity();q.mat3=c})(TSM||(TSM={}));
(function(q){var c=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(16);a&&this.init(a)};c.prototype.at=function(a){return this.values[a]};c.prototype.init=function(a){for(var b=0;16>b;b++)this.values[b]=a[b];return this};c.prototype.reset=function(){for(var a=0;16>a;a++)this.values[a]=0};c.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new c);for(var b=0;16>b;b++)a.values[b]=this.values[b];return a};c.prototype.all=function(){for(var a=[],b=0;16>b;b++)a[b]=
this.values[b];return a};c.prototype.row=function(a){return[this.values[4*a+0],this.values[4*a+1],this.values[4*a+2],this.values[4*a+3]]};c.prototype.col=function(a){return[this.values[a],this.values[a+4],this.values[a+8],this.values[a+12]]};c.prototype.equals=function(a){for(var b=0;16>b;b++)if(Math.abs(this.values[b]-a.at(b))>EPSILON)return!1;return!0};c.prototype.determinant=function(){var a=this.values[0],b=this.values[1],d=this.values[2],c=this.values[3],e=this.values[4],f=this.values[5],h=this.values[6],
j=this.values[7],i=this.values[8],l=this.values[9],m=this.values[10],n=this.values[11],k=this.values[12],s=this.values[13],t=this.values[14],u=this.values[15];return(a*f-b*e)*(m*u-n*t)-(a*h-d*e)*(l*u-n*s)+(a*j-c*e)*(l*t-m*s)+(b*h-d*f)*(i*u-n*k)-(b*j-c*f)*(i*t-m*k)+(d*j-c*h)*(i*s-l*k)};c.prototype.setIdentity=function(){this.values[0]=1;this.values[1]=0;this.values[2]=0;this.values[3]=0;this.values[4]=0;this.values[5]=1;this.values[6]=0;this.values[7]=0;this.values[8]=0;this.values[9]=0;this.values[10]=
1;this.values[11]=0;this.values[12]=0;this.values[13]=0;this.values[14]=0;this.values[15]=1;return this};c.prototype.transpose=function(){var a=this.values[1],b=this.values[2],d=this.values[3],c=this.values[6],e=this.values[7],f=this.values[11];this.values[1]=this.values[4];this.values[2]=this.values[8];this.values[3]=this.values[12];this.values[4]=a;this.values[6]=this.values[9];this.values[7]=this.values[13];this.values[8]=b;this.values[9]=c;this.values[11]=this.values[14];this.values[12]=d;this.values[13]=
e;this.values[14]=f;return this};c.prototype.inverse=function(){var a=this.values[0],b=this.values[1],d=this.values[2],c=this.values[3],e=this.values[4],f=this.values[5],h=this.values[6],j=this.values[7],i=this.values[8],l=this.values[9],m=this.values[10],n=this.values[11],k=this.values[12],s=this.values[13],t=this.values[14],u=this.values[15],x=a*f-b*e,p=a*h-d*e,r=a*j-c*e,w=b*h-d*f,v=b*j-c*f,q=d*j-c*h,z=i*s-l*k,A=i*t-m*k,B=i*u-n*k,C=l*t-m*s,D=l*u-n*s,E=m*u-n*t,y=x*E-p*D+r*C+w*B-v*A+q*z;if(!y)return null;
y=1/y;this.values[0]=(f*E-h*D+j*C)*y;this.values[1]=(-b*E+d*D-c*C)*y;this.values[2]=(s*q-t*v+u*w)*y;this.values[3]=(-l*q+m*v-n*w)*y;this.values[4]=(-e*E+h*B-j*A)*y;this.values[5]=(a*E-d*B+c*A)*y;this.values[6]=(-k*q+t*r-u*p)*y;this.values[7]=(i*q-m*r+n*p)*y;this.values[8]=(e*D-f*B+j*z)*y;this.values[9]=(-a*D+b*B-c*z)*y;this.values[10]=(k*v-s*r+u*x)*y;this.values[11]=(-i*v+l*r-n*x)*y;this.values[12]=(-e*C+f*A-h*z)*y;this.values[13]=(a*C-b*A+d*z)*y;this.values[14]=(-k*w+s*p-t*x)*y;this.values[15]=(i*
w-l*p+m*x)*y;return this};c.prototype.multiply=function(a){var b=this.values[0],d=this.values[1],c=this.values[2],e=this.values[3],f=this.values[4],h=this.values[5],j=this.values[6],i=this.values[7],l=this.values[8],m=this.values[9],n=this.values[10],k=this.values[11],s=this.values[12],t=this.values[13],u=this.values[14],x=this.values[15],p=a.at(0),r=a.at(1),w=a.at(2),v=a.at(3);this.values[0]=p*b+r*f+w*l+v*s;this.values[1]=p*d+r*h+w*m+v*t;this.values[2]=p*c+r*j+w*n+v*u;this.values[3]=p*e+r*i+w*k+
v*x;p=a.at(4);r=a.at(5);w=a.at(6);v=a.at(7);this.values[4]=p*b+r*f+w*l+v*s;this.values[5]=p*d+r*h+w*m+v*t;this.values[6]=p*c+r*j+w*n+v*u;this.values[7]=p*e+r*i+w*k+v*x;p=a.at(8);r=a.at(9);w=a.at(10);v=a.at(11);this.values[8]=p*b+r*f+w*l+v*s;this.values[9]=p*d+r*h+w*m+v*t;this.values[10]=p*c+r*j+w*n+v*u;this.values[11]=p*e+r*i+w*k+v*x;p=a.at(12);r=a.at(13);w=a.at(14);v=a.at(15);this.values[12]=p*b+r*f+w*l+v*s;this.values[13]=p*d+r*h+w*m+v*t;this.values[14]=p*c+r*j+w*n+v*u;this.values[15]=p*e+r*i+w*
k+v*x;return this};c.prototype.multiplyVec3=function(a){var b=a.x,d=a.y,a=a.z;return new q.vec3([this.values[0]*b+this.values[4]*d+this.values[8]*a+this.values[12],this.values[1]*b+this.values[5]*d+this.values[9]*a+this.values[13],this.values[2]*b+this.values[6]*d+this.values[10]*a+this.values[14]])};c.prototype.multiplyVec4=function(a){var b=a.x,d=a.y,c=a.z,a=a.w;return new q.vec4([this.values[0]*b+this.values[4]*d+this.values[8]*c+this.values[12]*a,this.values[1]*b+this.values[5]*d+this.values[9]*
c+this.values[13]*a,this.values[2]*b+this.values[6]*d+this.values[10]*c+this.values[14]*a,this.values[3]*b+this.values[7]*d+this.values[11]*c+this.values[15]*a])};c.prototype.toMat3=function(){return new q.mat3([this.values[0],this.values[1],this.values[2],this.values[4],this.values[5],this.values[6],this.values[8],this.values[9],this.values[10]])};c.prototype.toInverseMat3=function(){var a=this.values[0],b=this.values[1],d=this.values[2],c=this.values[4],e=this.values[5],f=this.values[6],h=this.values[8],
j=this.values[9],i=this.values[10],l=i*e-f*j,m=-i*c+f*h,n=j*c-e*h,k=a*l+b*m+d*n;if(!k)return null;k=1/k;return new q.mat3([l*k,(-i*b+d*j)*k,(f*b-d*e)*k,m*k,(i*a-d*h)*k,(-f*a+d*c)*k,n*k,(-j*a+b*h)*k,(e*a-b*c)*k])};c.prototype.translate=function(a){var b=a.x,d=a.y,a=a.z;this.values[12]+=this.values[0]*b+this.values[4]*d+this.values[8]*a;this.values[13]+=this.values[1]*b+this.values[5]*d+this.values[9]*a;this.values[14]+=this.values[2]*b+this.values[6]*d+this.values[10]*a;this.values[15]+=this.values[3]*
b+this.values[7]*d+this.values[11]*a;return this};c.prototype.scale=function(a){var b=a.x,d=a.y,a=a.z;this.values[0]*=b;this.values[1]*=b;this.values[2]*=b;this.values[3]*=b;this.values[4]*=d;this.values[5]*=d;this.values[6]*=d;this.values[7]*=d;this.values[8]*=a;this.values[9]*=a;this.values[10]*=a;this.values[11]*=a;return this};c.prototype.rotate=function(a,b){var d=b.x,c=b.y,e=b.z,f=Math.sqrt(d*d+c*c+e*e);if(!f)return null;1!==f&&(f=1/f,d*=f,c*=f,e*=f);var h=Math.sin(a),j=Math.cos(a),i=1-j,f=
this.values[0],l=this.values[1],m=this.values[2],n=this.values[3],k=this.values[4],s=this.values[5],t=this.values[6],u=this.values[7],x=this.values[8],p=this.values[9],r=this.values[10],w=this.values[11],v=d*d*i+j,q=c*d*i+e*h,z=e*d*i-c*h,A=d*c*i-e*h,B=c*c*i+j,C=e*c*i+d*h,D=d*e*i+c*h,d=c*e*i-d*h,e=e*e*i+j;this.values[0]=f*v+k*q+x*z;this.values[1]=l*v+s*q+p*z;this.values[2]=m*v+t*q+r*z;this.values[3]=n*v+u*q+w*z;this.values[4]=f*A+k*B+x*C;this.values[5]=l*A+s*B+p*C;this.values[6]=m*A+t*B+r*C;this.values[7]=
n*A+u*B+w*C;this.values[8]=f*D+k*d+x*e;this.values[9]=l*D+s*d+p*e;this.values[10]=m*D+t*d+r*e;this.values[11]=n*D+u*d+w*e;return this};c.frustum=function(a,b,d,g,e,f){var h=b-a,j=g-d,i=f-e;return new c([2*e/h,0,0,0,0,2*e/j,0,0,(b+a)/h,(g+d)/j,-(f+e)/i,-1,0,0,-(2*f*e)/i,0])};c.perspective=function(a,b,d,g){a=d*Math.tan(a*Math.PI/360);b*=a;return c.frustum(-b,b,-a,a,d,g)};c.orthographic=function(a,b,d,g,e,f){var h=b-a,j=g-d,i=f-e;return new c([2/h,0,0,0,0,2/j,0,0,0,0,-2/i,0,-(a+b)/h,-(g+d)/j,-(f+e)/
i,1])};c.lookAt=function(a,b,d){var g,e,f,h,j,i,l,m=a.x,n=a.y,a=a.z;f=d.x;h=d.y;e=d.z;l=b.x;d=b.y;g=b.z;if(m===l&&n===d&&a===g)return this.setIdentity();b=m-l;d=n-d;l=a-g;var k=1/Math.sqrt(b*b+d*d+l*l),b=b*k,d=d*k;l*=k;g=h*l-e*d;e=e*b-f*l;f=f*d-h*b;(k=Math.sqrt(g*g+e*e+f*f))?(k=1/k,g*=k,e*=k,f*=k):f=e=g=0;h=d*f-l*e;j=l*g-b*f;i=b*e-d*g;(k=Math.sqrt(h*h+j*j+i*i))?(k=1/k,h*=k,j*=k,i*=k):i=j=h=0;return new c([g,h,b,0,e,j,d,0,f,i,l,0,-(g*m+e*n+f*a),-(h*m+j*n+i*a),-(b*m+d*n+l*a),1])};c.product=function(a,
b,d){"undefined"===typeof d&&(d=null);var g=a.at(0),e=a.at(1),f=a.at(2),h=a.at(3),j=a.at(4),i=a.at(5),l=a.at(6),m=a.at(7),n=a.at(8),k=a.at(9),s=a.at(10),t=a.at(11),u=a.at(12),q=a.at(13),p=a.at(14),a=a.at(15),r=b.at(0),w=b.at(1),v=b.at(2),F=b.at(3),z=b.at(4),A=b.at(5),B=b.at(6),C=b.at(7),D=b.at(8),E=b.at(9),y=b.at(10),G=b.at(11),H=b.at(12),I=b.at(13),J=b.at(14),b=b.at(15);if(d)d.init([r*g+w*j+v*n+F*u,r*e+w*i+v*k+F*q,r*f+w*l+v*s+F*p,r*h+w*m+v*t+F*a,z*g+A*j+B*n+C*u,z*e+A*i+B*k+C*q,z*f+A*l+B*s+C*p,z*
h+A*m+B*t+C*a,D*g+E*j+y*n+G*u,D*e+E*i+y*k+G*q,D*f+E*l+y*s+G*p,D*h+E*m+y*t+G*a,H*g+I*j+J*n+b*u,H*e+I*i+J*k+b*q,H*f+I*l+J*s+b*p,H*h+I*m+J*t+b*a]);else return new c([r*g+w*j+v*n+F*u,r*e+w*i+v*k+F*q,r*f+w*l+v*s+F*p,r*h+w*m+v*t+F*a,z*g+A*j+B*n+C*u,z*e+A*i+B*k+C*q,z*f+A*l+B*s+C*p,z*h+A*m+B*t+C*a,D*g+E*j+y*n+G*u,D*e+E*i+y*k+G*q,D*f+E*l+y*s+G*p,D*h+E*m+y*t+G*a,H*g+I*j+J*n+b*u,H*e+I*i+J*k+b*q,H*f+I*l+J*s+b*p,H*h+I*m+J*t+b*a])};c.identity=(new c).setIdentity();q.mat4=c})(TSM||(TSM={}));
(function(q){var c=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(4);a&&(this.xyzw=a)};Object.defineProperty(c.prototype,"x",{get:function(){return this.values[0]},set:function(a){this.values[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"y",{get:function(){return this.values[1]},set:function(a){this.values[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"z",{get:function(){return this.values[2]},set:function(a){this.values[2]=
a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"w",{get:function(){return this.values[3]},set:function(a){this.values[3]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"xyz",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(a){this.values[0]=
a[0];this.values[1]=a[1];this.values[2]=a[2]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"xyzw",{get:function(){return[this.values[0],this.values[1],this.values[2],this.values[3]]},set:function(a){this.values[0]=a[0];this.values[1]=a[1];this.values[2]=a[2];this.values[3]=a[3]},enumerable:!0,configurable:!0});c.prototype.at=function(a){return this.values[a]};c.prototype.reset=function(){for(var a=0;4>a;a++)this.values[a]=0};c.prototype.copy=function(a){"undefined"===typeof a&&
(a=null);a||(a=new c);for(var b=0;4>b;b++)a.values[b]=this.values[b];return a};c.prototype.roll=function(){var a=this.x,b=this.y,c=this.z,g=this.w;return Math.atan2(2*(a*b+g*c),g*g+a*a-b*b-c*c)};c.prototype.pitch=function(){var a=this.x,b=this.y,c=this.z,g=this.w;return Math.atan2(2*(b*c+g*a),g*g-a*a-b*b+c*c)};c.prototype.yaw=function(){return Math.asin(2*(this.x*this.z-this.w*this.y))};c.prototype.equals=function(a){for(var b=0;4>b;b++)if(Math.abs(this.values[b]-a.at(b))>EPSILON)return!1;return!0};
c.prototype.setIdentity=function(){this.z=this.y=this.x=0;this.w=1;return this};c.prototype.calculateW=function(){var a=this.x,b=this.y,c=this.z;this.w=-Math.sqrt(Math.abs(1-a*a-b*b-c*c));return this};c.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w};c.prototype.inverse=function(){var a=a(this,this);if(!a)return this.xyzw=[0,0,0,0],this;a=a?1/a:0;this.x*=-a;this.y*=-a;this.z*=-a;this.w*=a;return this};c.prototype.conjugate=function(){this.values[0]*=-1;this.values[1]*=-1;this.values[2]*=
-1;return this};c.prototype.length=function(){var a=this.x,b=this.y,c=this.z,g=this.w;return Math.sqrt(a*a+b*b+c*c+g*g)};c.prototype.normalize=function(){var a=this.x,b=this.y,c=this.z,g=this.w,e=Math.sqrt(a*a+b*b+c*c+g*g);if(!e)return this.w=this.z=this.y=this.x=0,this;e=1/e;this.values[0]=a*e;this.values[1]=b*e;this.values[2]=c*e;this.values[3]=g*e;return this};c.prototype.add=function(a){for(var b=0;4>b;b++)this.values[b]+=a.at(b);return this};c.prototype.multiply=function(a){var b=this.values[0],
c=this.values[1],g=this.values[2],e=this.values[3],f=a.x,h=a.y,j=a.z,a=a.w;this.x=b*a+e*f+c*j-g*h;this.y=c*a+e*h+g*f-b*j;this.z=g*a+e*j+b*h-c*f;this.w=e*a-b*f-c*h-g*j;return this};c.prototype.multiplyVec3=function(a){var b=a.x,c=a.y,g=a.z,a=this.x,e=this.y,f=this.z,h=this.w,j=h*b+e*g-f*c,i=h*c+f*b-a*g,l=h*g+a*c-e*b,b=-a*b-e*c-f*g;return new q.vec3([j*h+b*-a+i*-f-l*-e,i*h+b*-e+l*-a-j*-f,l*h+b*-f+j*-e-i*-a])};c.prototype.toMat3=function(){var a=this.x,b=this.y,c=this.z,g=this.w,e=a+a,f=b+b,h=c+c,j=
a*e,i=a*f,a=a*h,l=b*f,b=b*h,c=c*h,e=g*e,f=g*f,g=g*h;return new q.mat3([1-(l+c),i+g,a-f,i-g,1-(j+c),b+e,a+f,b-e,1-(j+l)])};c.prototype.toMat4=function(){var a=this.x,b=this.y,c=this.z,g=this.w,e=a+a,f=b+b,h=c+c,j=a*e,i=a*f,a=a*h,l=b*f,b=b*h,c=c*h,e=g*e,f=g*f,g=g*h;return new q.mat4([1-(l+c),i+g,a-f,0,i-g,1-(j+c),b+e,0,a+f,b-e,1-(j+l),0,0,0,0,1])};c.sum=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xyzw=[a.x+b.x,a.y+b.y,a.z+b.z,a.w+b.w];else return new c([a.x+b.x,a.y+b.y,a.z+b.z,a.w+b.w])};
c.product=function(a,b,d){"undefined"===typeof d&&(d=null);var g=a.x,e=a.y,f=a.z,a=a.w,h=b.x,j=b.y,i=b.z,b=b.w;if(d)d.xyzw=[g*b+a*h+e*i-f*j,e*b+a*j+f*h-g*i,f*b+a*i+g*j-e*h,a*b-g*h-e*j-f*i];else return new c([g*b+a*h+e*i-f*j,e*b+a*j+f*h-g*i,f*b+a*i+g*j-e*h,a*b-g*h-e*j-f*i])};c.interpolate=function(a,b,d,g){"undefined"===typeof g&&(g=null);var e=a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w;if(1<=Math.abs(e))return new c([a.x,a.y,a.z,a.w]);var f=Math.acos(e),h=Math.sqrt(1-e*e);if(0.0010>Math.abs(h))return new c([0.5*
a.x+0.5*b.x,0.5*a.y+0.5*b.y,0.5*a.z+0.5*b.z,0.5*a.w+0.5*b.w]);e=Math.sin((1-d)*f)/h;d=Math.sin(d*f)/h;if(g)g.xyzw=[a.x*e+b.x*d,a.y*e+b.y*d,a.z*e+b.z*d,a.w*e+b.w*d];else return new c([a.x*e+b.x*d,a.y*e+b.y*d,a.z*e+b.z*d,a.w*e+b.w*d])};c.identity=(new c).setIdentity();q.quat=c})(TSM||(TSM={}));var EPSILON=1E-6;
(function(q){var c=function(a){"undefined"===typeof a&&(a=null);this.values=new Float32Array(2);a&&(this.xy=a)};Object.defineProperty(c.prototype,"x",{get:function(){return this.values[0]},set:function(a){this.values[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"y",{get:function(){return this.values[1]},set:function(a){this.values[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(a){this.values[0]=
a[0];this.values[1]=a[1]},enumerable:!0,configurable:!0});c.prototype.at=function(a){return this.values[a]};c.prototype.reset=function(){for(var a=0;2>a;a++)this.values[a]=0};c.prototype.copy=function(a){"undefined"===typeof a&&(a=null);a||(a=new c);for(var b=0;2>b;b++)a.values[b]=this.values[b];return a};c.prototype.negate=function(){for(var a=0;2>a;a++)this.values[a]*=-1;return this};c.prototype.equals=function(a){for(var b=0;2>b;b++)if(Math.abs(this.values[b]-a.at(b))>EPSILON)return!1;return!0};
c.prototype.length=function(){return Math.sqrt(this.squaredLength())};c.prototype.squaredLength=function(){var a=this.x,b=this.y;return a*a+b*b};c.prototype.add=function(a){for(var b=0;2>b;b++)this.values[b]+=a.at(b);return this};c.prototype.subtract=function(a){for(var b=0;2>b;b++)this.values[b]-=a.at(b);return this};c.prototype.multiply=function(a){for(var b=0;2>b;b++)this.values[b]*=a.at(b);return this};c.prototype.divide=function(a){for(var b=0;2>b;b++)this.values[b]/=a.at(b);return this};c.prototype.scale=
function(a){for(var b=0;2>b;b++)this.values[b]*=a;return this};c.prototype.normalize=function(){var a=this.length();if(1===a)return this;if(0===a){for(var b=0;2>b;b++)this.values[b]=0;return this}a=1/a;for(b=0;2>b;b++)this.values[b]*=a;return this};c.cross=function(a,b,c){"undefined"===typeof c&&(c=null);a=a.x*b.y-a.y*b.x;if(c)c.xyz=[0,0,a];else return new q.vec3([0,0,a])};c.dot=function(a,b){return a.x*b.x+a.y*b.y};c.distance=function(a,b){return Math.sqrt(this.squaredDistance(a,b))};c.squaredDistance=
function(a,b){var c=b.x-a.x,g=b.y-a.y;return c*c+g*g};c.direction=function(a,b,d){"undefined"===typeof d&&(d=null);var g=a.x-b.x,a=a.y-b.y,b=Math.sqrt(g*g+a*a);if(0===b)return new c([0,0]);b=1/b;if(d)d.xy=[g*b,a*b];else return new c([g*b,a*b])};c.interpolate=function(a,b,d,g){"undefined"===typeof g&&(g=null);var e=a.x,a=a.y,f=b.x,b=b.y;if(g)g.xy=[e+d*(f-e),a+d*(b-a)];else return new c([e+d*(f-e),a+d*(b-a)])};c.sum=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xy=[a.x+b.x,a.y+b.y];else return new c([a.x+
b.x,a.y+b.y])};c.difference=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xy=[a.x-b.x,a.y-b.y];else return new c([a.x-b.x,a.y-b.y])};c.product=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xy=[a.x*b.x,a.y*b.y];else return new c([a.x*b.x,a.y*b.y])};c.quotient=function(a,b,d){"undefined"===typeof d&&(d=null);if(d)d.xy=[a.x/b.x,a.y/b.y];else return new c([a.x/b.x,a.y/b.y])};c.zero=new c([0,0]);q.vec2=c})(TSM||(TSM={}));
